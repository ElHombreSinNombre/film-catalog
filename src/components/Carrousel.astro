---
import Tile from '@components/Tile.astro'
import EmptyTile from '@components/EmptyTile.astro'
import type TMDBMovie from '@interfaces/tmdb'
import { getAll } from '../endpoints/tmdb'

const movies = await getAll().catch((error) => {
  console.error('Error loading movies:', error)
})
---

{
  !movies ? (
    <EmptyTile />
  ) : (
    <section class='w-full' aria-label='Film carrousel'>
      <ul class='carousel' role='list'>
        {movies.map((item: TMDBMovie, index: number) => (
          <li
            class='w-48 flex-none snap-start group relative'
            aria-label={`Show details of ${item.title}`}
          >
            <span class='absolute bottom-1 right-1 z-10 text-4xl font-bold text-white/50 transition-opacity duration-300 group-hover:opacity-0 group-focus-within:opacity-0'>
              {index + 1}
            </span>
            <a href={`/film/${item.id}`}>
              <Tile movie={item} />
            </a>
          </li>
        ))}
      </ul>
    </section>
  )
}
